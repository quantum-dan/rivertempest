<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TempEst Modeling &#8212; RiverTempest.org</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=2bf1fcf8" />
    
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="_static/TempEstICOSquare.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TempEst 1" href="tempest1/readme.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tempest1/readme.html" title="TempEst 1"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">RiverTempest.org</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">TempEst Modeling</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tempest-modeling">
<h1>TempEst Modeling<a class="headerlink" href="#tempest-modeling" title="Link to this heading">¶</a></h1>
<p>The TempEst (stream TEMPerature ESTimation) models are a suite of river temperature models focused on sites without local monitoring data (ungaged modeling). At one-kilometer resolution, TempEst models provide the fastest available estimates of historical stream temperatures at daily (including mean and maximum) and monthly timesteps. This website includes documentation and references for the TempEst models and related projects. A notable spinoff is libSCHEMA, a Python package which provides a generic implementation of the SCHEMA modeling framework (see TempEst 2 reference) - you provide the model logic, libSCHEMA handles all the computation details (including a Basic Model Interface implementation for use with the NextGen National Water Model Framework).</p>
<p>If you use TempEst models, software, or data in your research, please cite the appropriate reference, listed <a class="reference external" href="#links-and-references">below</a>. All TempEst software is available under the terms of the GNU General Public License v3, meaning that you are free to use, modify, and redistribute the software with appropriate attribution and so long as any derivative software is made open-source under the same terms.</p>
<p>Any TempEst software featured on this website is usable and reasonably complete, and may or may not be under active development. All major TempEst models undergo peer review by way of the accompanying manuscript, though spinoff software with minimal new scientific content may not (for example, the SCHEMA framework is introduced in the peer-reviewed TempEst 2 paper, but LibSCHEMA, which did not exist at the time of publication, has not undergone further peer review in its own right).</p>
<p>I am willing to consider minor feature requests via the projects’ respective Issues pages, but make no guarantees about carrying them out. I am particularly interested in hearing about modifications to the workflow that would be helpful in practical use. I am also willing to reimplement TempEst 1/2 data retrieval independently of Google Earth Engine upon request.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tempest1/readme.html">TempEst 1 Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tempest1/readme.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest1/readme.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest1/readme.html#data-collection">Data Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest1/readme.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest1/readme.html#citation">Citation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tempest2/readme.html">TempEst 2 Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tempest2/readme.html#quick-guide">Quick Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2/readme.html#citation-and-more-information">Citation and More Information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tempest2fast/readme.html">TempEst 2-FAST Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/readme.html#usage-guide">Usage Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/readme.html#citation-and-more-information">Citation and More Information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tempest2fast/tempest2fast.html">TempEst 2-FAST Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.defaults">tempest2fast.defaults module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.dem">tempest2fast.dem module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.humidity">tempest2fast.humidity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.lcov">tempest2fast.lcov module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.lst">tempest2fast.lst module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.prediction">tempest2fast.prediction module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.rivers">tempest2fast.rivers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast.ufuncs">tempest2fast.ufuncs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tempest2fast/tempest2fast.html#module-tempest2fast">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="newt/readme.html">TempEst-NEWT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="newt/readme.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/readme.html#detailed-documentation">Detailed Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/readme.html#capabilities-overview">Capabilities Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/readme.html#citation">Citation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="next/readme.html">TempEst-NEXT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="next/readme.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/readme.html#detailed-documentation">Detailed Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/readme.html#design-overview">Design Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/readme.html#citation">Citation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="newt/NEWT.html">TempEst-NEWT Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#module-NEWT.analysis">NEWT.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#module-NEWT.bmi">NEWT.bmi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#module-NEWT.engines">NEWT.engines module</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#module-NEWT.statics">NEWT.statics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#module-NEWT.watershed">NEWT.watershed module</a></li>
<li class="toctree-l2"><a class="reference internal" href="newt/NEWT.html#module-NEWT">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="next/NEXT.html">TempEst-NEXT Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT.coef_est">NEXT.coef_est module</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT.data">NEXT.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT.datatools">NEXT.datatools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT.model_manager">NEXT.model_manager module</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT.reach_prep">NEXT.reach_prep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT.wforecast">NEXT.wforecast module</a></li>
<li class="toctree-l2"><a class="reference internal" href="next/NEXT.html#module-NEXT">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="libschema/readme.html">LibSCHEMA Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="libschema/readme.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/readme.html#general-concept">General Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/readme.html#implemented-functionality">Implemented Functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/readme.html#required-functionality">Required Functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/readme.html#citation">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/readme.html#reference-overview">Reference Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="libschema/libschema.html">LibSCHEMA Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="libschema/libschema.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/libschema.html#module-libschema.analysis">libschema.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/libschema.html#module-libschema.bmi">libschema.bmi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/libschema.html#module-libschema.classes">libschema.classes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/libschema.html#module-libschema.model">libschema.model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="libschema/libschema.html#module-libschema">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="tempest-software-notes">
<h1>TempEst Software Notes<a class="headerlink" href="#tempest-software-notes" title="Link to this heading">¶</a></h1>
<p>Full descriptions should be sought in the Overview links above.</p>
<p>The TempEst models differ substantially in their architecture, but a shared characteristic is that their prediction and data retrieval implementations are completely independent of the presence of a gage. They are all capable of running entirely off of coordinates, with no reference to established monitoring locations and using datasets that are available for the entire contiguous United States. They are also rigorously tested for ungaged use and extrapolation capabilities, including their performance for unseen regions (i.e., with no nearby gages to learn from), unseen time windows (testing their stability in time), and unseen elevations (evaluating their ability to extrapolate upwards).</p>
<p>TempEst 1 and 2 are provided as R scripts with Google Earth Engine data retrieval code. LibSCHEMA is a Python package.</p>
<section id="tempest-1">
<h2>TempEst 1<a class="headerlink" href="#tempest-1" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/TempEst1.png"><img alt="TempEst 1 Logo" src="_images/TempEst1.png" style="width: 300px;" />
</a>
<p>TempEst 1 is the model that started it all, and may be described as just “TempEst”. TempEst 1 is a machine learning (random forest) model that uses high-resolution, but low-frequency Landsat land surface temperature (LST) to estimate monthly mean stream temperatures, demonstrated for rivers from a few meters to a kilometer wide and for both minimally-disturbed and heavily-modified watersheds. TempEst 1 is the fastest way to get an estimate of general temperature trends.</p>
<p>Scientifically, TempEst 1 demonstrated that “point-oriented, sitewise” models - meaning those that use data just for the point of interest, not the entire watershed (point-oriented) and do not consider the rest of the river network (sitewise) - can generate skillful stream temperature predictions with far lower computational and data requirements than watershed-oriented or network-aware models. TempEst 1’s manuscript also established the extensive and rigorous testing procedures common to all subsequent TempEst modeling work and the use of wholly gage-independent data retrieval and prediction, with the manuscript including a demonstration for 100 unmonitored locations.</p>
</section>
<section id="tempest-2-and-fast">
<h2>TempEst 2 and FAST<a class="headerlink" href="#tempest-2-and-fast" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/TempEst2.png"><img alt="TempEst 2 Logo" src="_images/TempEst2.png" style="width: 300px;" />
</a>
<p>TempEst 2’s primary objective was to extend TempEst 1 to daily-resolution predictions. In the process, it established an entirely different architecture, retaining only the point-oriented, sitewise, LST-forced design. Experiments in the process of TempEst 2 development led to the creation of the Seasonal Conditions Historical Expectation with Modeled Anomaly (SCHEMA) architecture, a generalization of stochastic models. The SCHEMA architecture allowed TempEst 2 to be designed with linear geostatistical (kriging) models predicting site-specific coefficients, enabling improvements in simplicity, interpretability, efficiency, and extrapolation capability compared to TempEst 1.</p>
<p>TempEst 2-FAST (“Fast Analysis in Space and Time”) is a variant on TempEst 2 optimized for, well, what it says on the tin. TempEst 2 is optimized for predictions at a sample of specific points, and gets a bit unwieldy at over ~10,000 points or so (it also tends to require data chunking for over ~2,000 points). In general, that’s already a huge sample, and TempEst 2 works well for most use cases. However, one might want to analyze continuous, gridded SWT estimates over an entire state, large watershed, or country. There, TempEst 2 gets awkward. The solution: a version of TempEst 2 optimized for gridded application over large scales. That’s FAST. The model logic is the same, but designed to work over gridded data at 1-km resolution.</p>
<p>TempEst 2-FAST scales much better, but it takes a lot more computing setup than TempEst 2. Perhaps more importantly, since it uses a grid and not discrete points, it cannot be used to pinpoint a specific river near a confluence, for example.</p>
</section>
<section id="tempest-next-newt">
<h2>TempEst-NEXT/NEWT<a class="headerlink" href="#tempest-next-newt" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/TempEstNext.png"><img alt="TempEst-NEXT Logo" src="_images/TempEstNext.png" style="width: 300px;" />
</a>
<p>TempEst-NEWT/NEXT build on the SCHEMA foundation developed by TempEst 2 to implement forecasting. In the process, they improve support for nonstationarity and disturbances. TempEst-NEWT is a straightforward standalone implementation of SCHEMA for individual watersheds, and can be used as a watershed-specific model. It also supports modification engines to dynamically adjust model coefficients and has smarter anomaly handling than TempEst 2.</p>
<p>TempEst-NEXT, in turn, provides watershed generalization capabilities - coefficient estimation for ungaged watersheds. Unlike TempEst 2, there is more emphasis on directly physically relevant conditions and it does not use latitude or longitude, forcing the model to emphasize site behavior directly.</p>
</section>
<section id="libschema">
<h2>LibSCHEMA<a class="headerlink" href="#libschema" title="Link to this heading">¶</a></h2>
<p>LibSCHEMA is based on the possibility that the SCHEMA architecture might be more generally useful, allowing others to use it without having to implement most of the model software themselves. With LibSCHEMA, a researcher implementing a SCHEMA model need only provide functions for the core model logic - predicting the seasonal and anomaly terms. Then, the model logistics (processing input/output, running timesteps, etc) are provided automatically. LibSCHEMA also provides a Basic Model Interface implementation for those concerned with model interoperability, particularly through NOAA’s NextGen National Water Model Framework.</p>
<p>I have found that general logistics, rather than the core model logic, are responsible for the majority of the source code and the vast majority of debugging effort, so I hope that LibSCHEMA can spare other researchers considerable effort in model implementation.</p>
</section>
</section>
<section id="links-and-references">
<h1>Links and References<a class="headerlink" href="#links-and-references" title="Link to this heading">¶</a></h1>
<p>TempEst 1 (monthly temperature estimation): <a class="reference external" href="https://github.com/mines-ciroh/tempest1">https://github.com/mines-ciroh/tempest1</a> - Philippus, D., A. Sytsma, A. Rust, and T. S. Hogue. 2024. “A machine learning model for estimating the temperature of small rivers using satellite-based spatial data.” Remote Sensing of Environment, 311: 114271. <a class="reference external" href="https://doi.org/10.1016/j.rse.2024.114271">https://doi.org/10.1016/j.rse.2024.114271</a>.</p>
<p>TempEst 2 (daily temperature estimation): <a class="reference external" href="https://github.com/mines-ciroh/tempest2">https://github.com/mines-ciroh/tempest2</a> - Philippus, D., C. R. Corona, K. Schneider, A. Rust, and T. S. Hogue. 2025. “Satellite-based spatial-statistical modeling of daily stream water temperatures at the CONUS scale.” Journal of Hydrology, 661: 133321. <a class="reference external" href="https://doi.org/10.1016/j.jhydrol.2025.133321">https://doi.org/10.1016/j.jhydrol.2025.133321</a>.</p>
<p>TempEst-NEWT/NEXT (daily temperature forecasting): <a class="reference external" href="https://github.com/mines-ciroh/tempest-next">https://github.com/mines-ciroh/tempest-next</a>, <a class="reference external" href="https://github.com/mines-ciroh/tempest-newt">https://github.com/mines-ciroh/tempest-newt</a> - Philippus, Corona and Hogue. “Daily Stream Water Temperature Modeling and Forecasting for Ungaged Watersheds at the CONUS Scale.” In review.</p>
<p>LibSCHEMA (generic SCHEMA library): <a class="reference external" href="https://pypi.org/project/libschema/">https://pypi.org/project/libschema/</a> - cite TempEst 2.</p>
<p>Three-sine river temperature seasonality: <a class="reference external" href="https://pypi.org/project/rtseason/">https://pypi.org/project/rtseason/</a> - Philippus, D., C. R. Corona, and T. S. Hogue. 2024. “Improved Annual Temperature Cycle Function for Stream Seasonal Thermal Regimes.” Journal of the American Water Resources Association, 60 (6). <a class="reference external" href="https://doi.org/10.1111/1752-1688.13228">https://doi.org/10.1111/1752-1688.13228</a>.</p>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="#">
              <img class="logo" src="_static/TempEstNoNumberForDarkBackgrounds.png" alt="Logo of RiverTempest.org"/>
            </a></p>
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">TempEst Modeling</a></li>
<li><a class="reference internal" href="#tempest-software-notes">TempEst Software Notes</a><ul>
<li><a class="reference internal" href="#tempest-1">TempEst 1</a></li>
<li><a class="reference internal" href="#tempest-2-and-fast">TempEst 2 and FAST</a></li>
<li><a class="reference internal" href="#tempest-next-newt">TempEst-NEXT/NEWT</a></li>
<li><a class="reference internal" href="#libschema">LibSCHEMA</a></li>
</ul>
</li>
<li><a class="reference internal" href="#links-and-references">Links and References</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  </div>
<h3><a href="#">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tempest1/readme.html">TempEst 1 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tempest2/readme.html">TempEst 2 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tempest2fast/readme.html">TempEst 2-FAST Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tempest2fast/tempest2fast.html">TempEst 2-FAST Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="newt/readme.html">TempEst-NEWT Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="next/readme.html">TempEst-NEXT Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="newt/NEWT.html">TempEst-NEWT Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="next/NEXT.html">TempEst-NEXT Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="libschema/readme.html">LibSCHEMA Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="libschema/libschema.html">LibSCHEMA Reference</a></li>
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tempest1/readme.html" title="TempEst 1"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">RiverTempest.org</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">TempEst Modeling</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Daniel Philippus. Logos by Bert Philippus.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>